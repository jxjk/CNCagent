// 生成符合要求的NC程序
// X轴按工件长边摆放，G55原点在工件右上角
// 两个带沉孔的特征孔，按点孔、钻孔、沉孔工艺加工

const fs = require('fs');
const path = require('path');

// 符合要求的G代码内容
const gcodeContent = `O0001 (CNC程序 - 双沉头孔加工程序)
(X轴按工件长边摆放，G55原点在工件右上角)
G21 (毫米编程)
G40 (刀具半径补偿取消)
G49 (刀具长度补偿取消)
G80 (取消固定循环)
G90 (绝对编程)
G55 (工件坐标系2 - 右上角为原点)
G0 X0. Y0. S500 M03 (主轴正转，500转/分钟)

; 点孔工艺 - 批量加工两个孔
T01 M06 (换1号刀: 中心钻)
S1200 M03 (主轴正转，1200转/分钟，针对铝材优化)
G43 H01 Z100. (刀具长度补偿)
G0 X-20.000 Y-5.000 (定位到第一个孔位置)
G81 G98 Z-2.0 R2.0 F50 (点孔，深度2mm)
G0 X-80.000 Y-5.000 (定位到第二个孔位置)
G81 G98 Z-2.0 R2.0 F50 (点孔，深度2mm)
G80 (取消固定循环)
G0 Z100. (抬刀到安全高度)

; 钻孔工艺 - 批量加工两个孔
T02 M06 (换2号刀: 钻头)
S800 M03 (主轴正转，800转/分钟，针对铝材优化)
G43 H02 Z100. (刀具长度补偿)
G0 X-20.000 Y-5.000 (定位到第一个孔位置)
G83 G98 Z-13.8 R2.0 Q2.0 F100 (深孔钻，每次进给2mm，深度13.8mm)
G0 X-80.000 Y-5.000 (定位到第二个孔位置)
G83 G98 Z-13.8 R2.0 Q2.0 F100 (深孔钻，每次进给2mm，深度13.8mm)
G80 (取消固定循环)
G0 Z100. (抬刀到安全高度)

; 沉孔工艺 - 批量加工两个孔
T03 M06 (换3号刀: 沉头刀)
S600 M03 (主轴正转，600转/分钟，针对铝材优化)
G43 H03 Z100. (刀具长度补偿)
G0 X-20.000 Y-5.000 (定位到第一个孔位置)
G82 G98 Z-5.5 R2.0 P2000 F80 (沉孔，深度5.5mm，暂停2秒)
G0 X-80.000 Y-5.000 (定位到第二个孔位置)
G82 G98 Z-5.5 R2.0 P2000 F80 (沉孔，深度5.5mm，暂停2秒)
G80 (取消固定循环)
G0 Z100. (抬刀到安全高度)

M05 (主轴停止)
M30 (程序结束)
`;

// 写入文件
const outputPath = path.join(__dirname, '1.NC');
fs.writeFileSync(outputPath, gcodeContent);

console.log('NC程序已成功生成到 1.NC');
console.log('程序特性：');
console.log('- 使用G55坐标系（右上角为原点）');
console.log('- X轴按工件长边摆放');
console.log('- 两个孔的坐标为(-20.000, -5.000)和(-80.000, -5.000)');
console.log('- 按NC编程最佳实践批量加工（一次换刀加工两个孔）');
console.log('- 采用点孔、钻孔、沉孔的完整工艺');
console.log('- 使用了针对铝材优化的切削参数');