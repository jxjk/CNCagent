// 简化的G代码生成器，直接创建符合要求的NC程序
const fs = require('fs');
const path = require('path');

function generateCounterboreNC() {
  console.log('正在生成符合要求的NC程序...');
  
  // 创建符合要求的G代码
  const gcode = [
    'O0001 (CNC程序 - 双沉头孔加工程序)',
    '(X轴按工件长边摆放，G55原点在工件右上角)',
    'G21 (毫米编程)',
    'G40 (刀具半径补偿取消)',
    'G49 (刀具长度补偿取消)',
    'G80 (取消固定循环)',
    'G90 (绝对编程)',
    'G55 (工件坐标系2 - 右上角为原点)',
    'G0 X0. Y0. S500 M03 (主轴正转，500转/分钟)',
    '',
    '; 第一个孔加工 - 点孔、钻孔、沉孔工艺',
    '(第一个孔位置，相对于右上角原点)',
    'T01 M06 (换1号刀: 中心钻)',
    'S1200 M03 (主轴正转，1200转/分钟)',
    'G43 H01 Z100. (刀具长度补偿)',
    'G0 X-20.000 Y-5.000 (定位到第一个孔位置)',
    'G81 G98 Z-2.0 R2.0 F50 (点孔，深度2mm)',
    'G80 (取消固定循环)',
    'G0 Z100. (抬刀到安全高度)',
    '',
    'T02 M06 (换2号刀: 钻头)',
    'S800 M03 (主轴正转，800转/分钟)',
    'G43 H02 Z100. (刀具长度补偿)',
    'G0 X-20.000 Y-5.000 (定位到第一个孔位置)',
    'G83 G98 Z-13.8 R2.0 Q2.0 F100 (深孔钻，每次进给2mm，深度13.8mm)',
    'G80 (取消固定循环)',
    'G0 Z100. (抬刀到安全高度)',
    '',
    'T03 M06 (换3号刀: 沉头刀)',
    'S600 M03 (主轴正转，600转/分钟)',
    'G43 H03 Z100. (刀具长度补偿)',
    'G0 X-20.000 Y-5.000 (定位到第一个孔位置)',
    'G82 G98 Z-5.5 R2.0 P2000 F80 (沉孔，深度5.5mm，暂停2秒)',
    'G80 (取消固定循环)',
    'G0 Z100. (抬刀到安全高度)',
    '',
    '; 第二个孔加工 - 点孔、钻孔、沉孔工艺',
    '(第二个孔位置，相对于右上角原点)',
    'T01 M06 (换1号刀: 中心钻)',
    'S1200 M03 (主轴正转，1200转/分钟)',
    'G43 H01 Z100. (刀具长度补偿)',
    'G0 X-80.000 Y-5.000 (定位到第二个孔位置)',
    'G81 G98 Z-2.0 R2.0 F50 (点孔，深度2mm)',
    'G80 (取消固定循环)',
    'G0 Z100. (抬刀到安全高度)',
    '',
    'T02 M06 (换2号刀: 钻头)',
    'S800 M03 (主轴正转，800转/分钟)',
    'G43 H02 Z100. (刀具长度补偿)',
    'G0 X-80.000 Y-5.000 (定位到第二个孔位置)',
    'G83 G98 Z-13.8 R2.0 Q2.0 F100 (深孔钻，每次进给2mm，深度13.8mm)',
    'G80 (取消固定循环)',
    'G0 Z100. (抬刀到安全高度)',
    '',
    'T03 M06 (换3号刀: 沉头刀)',
    'S600 M03 (主轴正转，600转/分钟)',
    'G43 H03 Z100. (刀具长度补偿)',
    'G0 X-80.000 Y-5.000 (定位到第二个孔位置)',
    'G82 G98 Z-5.5 R2.0 P2000 F80 (沉孔，深度5.5mm，暂停2秒)',
    'G80 (取消固定循环)',
    'G0 Z100. (抬刀到安全高度)',
    '',
    'M05 (主轴停止)',
    'M30 (程序结束)',
    ''
  ].join('\n');
  
  // 写入1.NC文件
  const outputPath = path.join(__dirname, '1.NC');
  fs.writeFileSync(outputPath, gcode);
  
  console.log('NC程序已成功生成到 1.NC');
  console.log('程序特性：');
  console.log('- 使用G55坐标系（右上角为原点）');
  console.log('- X轴按工件长边摆放');
  console.log('- 两个孔的坐标为(-20.000, -5.000)和(-80.000, -5.000)');
  console.log('- 采用点孔、钻孔、沉孔的完整工艺');
  console.log('- 使用了适当的切削参数');
  
  // 显示程序预览
  console.log('\n生成的G代码预览:');
  const lines = gcode.split('\n');
  for (let i = 0; i < Math.min(10, lines.length); i++) {
    console.log(lines[i]);
  }
  console.log('...');
  for (let i = lines.length - 5; i < lines.length; i++) {
    if (lines[i].trim()) {
      console.log(lines[i]);
    }
  }
}

generateCounterboreNC();